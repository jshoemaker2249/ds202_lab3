---
title: "individual1"
author: "Jacob Shoemaker; jshoemaker2249"
date: "2/19/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
HAPPY <- readRDS("HAPPY.rds")
```

##Data Cleaning
1.
```{r}

HAPPY[HAPPY == "IAP" | HAPPY == "DK" | HAPPY == "NA"] <- NA

```

2. 
```{r}
HAPPY$HAPPY <- as.factor(HAPPY$HAPPY)
HAPPY$AGE <- as.numeric(HAPPY$AGE)
HAPPY$SEX <- as.factor(HAPPY$SEX)
HAPPY$MARITAL <- as.factor(HAPPY$MARITAL)
HAPPY$AGE <- ifelse(HAPPY$AGE == "89 OR OLDER", 89, HAPPY$AGE)
HAPPY$DEGREE <- as.factor(HAPPY$DEGREE)
HAPPY$FINRELA <- as.factor(HAPPY$FINRELA)
HAPPY$HEALTH <- as.factor(HAPPY$HEALTH)
HAPPY$PARTYID <- as.factor(HAPPY$PARTYID)
HAPPY$POLVIEWS <- as.factor(HAPPY$POLVIEWS)
```

3. 
```{r}
HAPPY$MARITAL <- factor(HAPPY$MARITAL, levels = c("NEVER MARRIED", "MARRIED", "SEPARATED", "DIVORCED", "WIDOWED"))
HAPPY$DEGREE <- factor(HAPPY$DEGREE, levels = c("LT HIGH SCHOOL", "HIGH SCHOOL", "JUNIOR COLLEGE", "BACHELOR", "GRADUATE"))
HAPPY$FINRELA <- factor(HAPPY$FINRELA, levels = c("FAR BELOW AVERAGE", "BELOW AVERAGE", "AVERAGE", "ABOVE AVERAGE", "FAR ABOVE AVERAGE"))
HAPPY$HEALTH <- factor(HAPPY$HEALTH, levels = c("POOR", "FAIR", "GOOD", "EXCELLENT"))
HAPPY$PARTYID <- factor(HAPPY$PARTYID, levels= unique(c("STRONG DEMOCRAT", "NOT STR DEMOCRAT", "IND,NEAR DEM","INDEPENDENT", "IND,NEAR REP", "NOT STR REPUBLICAN", "STRONG REPUBLICAN", "INDEPENDENT")))
HAPPY$POLVIEWS <- factor(HAPPY$POLVIEWS, levels = c("EXTREMELY LIBERAL", "LIBERAL", "SLIGHTLY LIBERAL", "MODERATE", "SLIGHTLY CONSERVATIVE", "CONSERVATIVE", "EXTRMLY CONSERVATIVE"))
HAPPY$HAPPY <- factor(HAPPY$HAPPY, levels = c("NOT TOO HAPPY", "PRETTY HAPPY", "VERY HAPPY"))



mean(HAPPY$AGE[HAPPY$MARITAL == "NEVER MARRIED"], na.rm = TRUE)
mean(HAPPY$AGE[HAPPY$MARITAL == "MARRIED"], na.rm = TRUE)
mean(HAPPY$AGE[HAPPY$MARITAL == "SEPARATED"], na.rm = TRUE)
mean(HAPPY$AGE[HAPPY$MARITAL == "DIVORCED"], na.rm = TRUE)
mean(HAPPY$AGE[HAPPY$MARITAL == "WIDOWED"], na.rm = TRUE)

HAPPY$MARITAL <- factor(HAPPY$MARITAL, levels = c("NEVER MARRIED", "SEPARATED", "MARRIED", "DIVORCED", "WIDOWED"))
```


##Data Exploration

1.  
```{r Variable Distribution}
library(ggplot2)
#distribution of sex by age
ggplot(HAPPY, aes(x=HAPPY, fill= MARITAL)) + geom_bar(na.rm = TRUE) + ggtitle("Distribution of Happiness and Marital Status") + xlab("Happiness") + ylab("Count")

#distribution of degree by sex
ggplot(HAPPY, aes(x=HAPPY, fill=FINRELA))+ geom_bar(na.rm = TRUE) + ggtitle("Distribution of Happiness and Opinion of Family Income") + ylab("Count") + xlab("Happiness") + guides(fill=guide_legend(title="Opinion of Family Income"))
```  


The first graph shows the distribution of happiness in relationship to marital status. From this, we can see that there is a signicant proportion of people in the "pretty happy" category that have never been married. At the same time, people that considered themselves to be "very happy" tend to be married rather than divorced. The second graph looks into the relationship between percepted financial standing and happiness. As you can see, to make the jump from "pretty happy" to "very happy," it appears that being at least average in terms of financial stability is necessary.


2.
```{r}
ggplot(HAPPY, aes(x=HAPPY, y=AGE, col=SEX)) + geom_boxplot(na.rm = TRUE)+ xlab("Happiness Level")+ ggtitle("Happiness and Age") + ylab("Age")



library(ggmosaic)
#color
#size
#2 more geoms
#scale
#coord_flip
#facet




```

3.
